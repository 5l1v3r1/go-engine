<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Go-Engine: Fichero Fuente C:/Dev/Proyectos/go-engine/engine/src/systems/_input.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Go-Engine
   &#160;<span id="projectnumber">alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Buscar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="pages.html"><span>Páginas&#160;relacionadas</span></a></li>
      <li><a href="modules.html"><span>Módulos</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Clases</span></a></li>
      <li class="current"><a href="files.html"><span>Archivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&#160;de&#160;archivos</span></a></li>
      <li><a href="globals.html"><span>Miembros&#160;de&#160;los&#160;ficheros</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Todo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Clases</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Archivos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Funciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>&apos;typedefs&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumeraciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Valores de enumeraciones</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Amigas</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>&apos;defines&apos;</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Grupos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Páginas</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_996f45160da62e1a3d7f6046fad68f51.html">engine</a></li><li class="navelem"><a class="el" href="dir_3d9126aa00c041bc0b8f859d1965a0f4.html">src</a></li><li class="navelem"><a class="el" href="dir_c40367b30ab293dcfc5239bb834d4d97.html">systems</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">_input.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="__input_8cpp.html">Ir a la documentación de este archivo.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="__input_8h.html">systems/_input.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="__data_8h.html">systems/_data.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="__debug_8h.html">systems/_debug.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="__render_8h.html">systems/_render.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="__input_8cpp.html#a3ab458c50394cc90508977826a718f0e">    6</a></span>&#160;<a class="code" href="class_c_system___user_input.html">CSystem_UserInput</a> <a class="code" href="__input_8h.html#a3ab458c50394cc90508977826a718f0e">gSystem_UserInput</a>;</div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="__input_8cpp.html#a207511edbc2cbed20101d8f7b0987d0f">    7</a></span>&#160;<a class="code" href="class_c_system___user_input.html">CSystem_UserInput</a>&amp; <a class="code" href="__input_8h.html#a207511edbc2cbed20101d8f7b0987d0f">gUserInput</a> = <a class="code" href="__input_8h.html#a3ab458c50394cc90508977826a718f0e">gSystem_UserInput</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//const Uint8* CSystem_UserInput::keyboard = SDL_GetKeyboardState(NULL);</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using namespace </span>Input;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CKey::OnInput(<span class="keyword">const</span> <a class="code" href="class_c_system___user_input.html">CSystem_UserInput</a>&amp; input = gSystem_UserInput)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">if</span> ((state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">Input::key_keyup</a> or state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">Input::key_unpressed</a>) and input.keyboard[key])</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">Input::key_keydown</a>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">Input::key_keydown</a> or state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">Input::key_pressed</a>) and !input.keyboard[key])</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">Input::key_keyup</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">Input::key_keydown</a> and input.keyboard[key])</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">Input::key_pressed</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">Input::key_keyup</a> and !input.keyboard[key])</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">Input::key_unpressed</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;}</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CKeyAxis::OnInput(<span class="keyword">const</span> <a class="code" href="class_c_system___user_input.html">CSystem_UserInput</a>&amp; input = gSystem_UserInput)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">// ---- Para los ejes, usamos máquinas de estado para alternar entre los estados unpressed, keydown, key_pressed y keyup.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="comment">// - Up</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">if</span>((v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> or v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>) and input.keyboard[v_up.key])</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    vertical += 1.0;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    v_up.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> or v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>) and !input.keyboard[v_up.key])</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    vertical -= 1.0;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    v_up.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> and input.keyboard[v_up.key])</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    v_up.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v_up.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> and !input.keyboard[v_up.key])</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    v_up.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// - Down</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">if</span>((v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> or v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>) and input.keyboard[v_down.key])</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    vertical -= 1.0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    v_down.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> or v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>) and !input.keyboard[v_down.key])</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    vertical += 1.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    v_down.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> and input.keyboard[v_down.key])</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    v_down.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(v_down.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> and !input.keyboard[v_down.key])</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    v_down.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">// - Left</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">if</span>((h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> or h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>) and input.keyboard[h_left.key])</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    horizontal -= 1.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    h_left.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> or h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>) and !input.keyboard[h_left.key])</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    horizontal += 1.0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    h_left.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> and input.keyboard[h_left.key])</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    h_left.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(h_left.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> and !input.keyboard[h_left.key])</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    h_left.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// - Right</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">if</span>((h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> or h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>) and input.keyboard[h_right.key])</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    horizontal += 1.0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>((h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> or h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>) and !input.keyboard[h_right.key])</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    horizontal -= 1.0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a> and input.keyboard[h_right.key])</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(h_right.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a> and !input.keyboard[h_right.key])</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#aff3a72164d9831a8fbc86a8b6cd8d539">   95</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_system___user_input.html#aff3a72164d9831a8fbc86a8b6cd8d539">CSystem_UserInput::Init</a>()</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span>(enabled) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Axis</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  axis1.horizontal = axis2.horizontal = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  axis1.vertical = axis2.vertical = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  axis1.v_up.state = axis1.v_down.state = axis1.h_left.state = axis1.h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  axis2.v_up.state = axis2.v_down.state = axis2.h_left.state = axis2.h_right.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  axis1.v_up.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS1_UP_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  axis1.v_down.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS1_DOWN_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  axis1.h_left.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS1_LEFT_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  axis1.h_right.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS1_RIGHT_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  axis2.v_up.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS2_UP_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  axis2.v_down.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS2_DOWN_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  axis2.h_left.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS2_LEFT_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  axis2.h_right.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_AXIS2_RIGHT_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Actions</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  action1.state = action2.state = action3.state = action4.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  action1.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_ACTION1_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  action2.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_ACTION2_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  action3.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_ACTION3_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  action4.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_ACTION4_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  run.state = crouch.state = jump.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  run.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_RUN_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  crouch.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_CROUCH_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  jump.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_JUMP_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  console.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  console.key = SDL_GetScancodeFromName(<a class="code" href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a>.<a class="code" href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">GetString</a>(<span class="stringliteral">&quot;__INPUT_CONSOLE_KEY&quot;</span>).c_str());</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// Mouse</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">if</span>(!mouse.Init())</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#a0a3ec326a010e7b65ead579cc626442a">msg_box</a>(<a class="code" href="namespace_debug.html#a49a7325e26aabc517b2104298dc39695ae46f71bd5ed0e9e76ba7cd4dd3b07019">Debug::error</a>, <a class="code" href="__globals_8h.html#a3d470c3e2db920debdd2f758bcc04dfa">ERROR_INIT</a>, <span class="stringliteral">&quot;From UserInput: Could not load mouse device&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Joystick</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span>(!RebuildJoysticks())</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#a0a3ec326a010e7b65ead579cc626442a">msg_box</a>(<a class="code" href="namespace_debug.html#a49a7325e26aabc517b2104298dc39695ae46f71bd5ed0e9e76ba7cd4dd3b07019">Debug::error</a>, <a class="code" href="__globals_8h.html#a3d470c3e2db920debdd2f758bcc04dfa">ERROR_INIT</a>, <span class="stringliteral">&quot;From UserInput: Could not load joysticks devices&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  rebuild_joysticks = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  rebuild_joysticks_timeout = 0.f;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="class_c_system.html#a5de409e36b7857940be16635a49101f9">CSystem::Init</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a5eb139fc1b46740a4fdf966fb4593e8b">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#a5eb139fc1b46740a4fdf966fb4593e8b">CSystem_UserInput::Close</a>()</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordflow">if</span>(!enabled) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="class_c_system.html#adf0c79665d86344b1fbe187f5c6fa3c5">CSystem::Close</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// Joystick</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">//SDL_QuitSubSystem(SDL_INIT_JOYSTICK);</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoystick&gt;::iterator it = joysticks.begin(); it != joysticks.end(); ++it)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    (*it).Close();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  joysticks.clear();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a5ca889d8cf1d985713c0915463e2beb7">  164</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_system___user_input.html#a5ca889d8cf1d985713c0915463e2beb7">CSystem_UserInput::Reset</a>()</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">// Un poco brusco, pero es lo ideal</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  Close();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">return</span> Init();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#aa4e4ab56ff55594d61fcc86ffa185a10">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#aa4e4ab56ff55594d61fcc86ffa185a10">CSystem_UserInput::OnInput</a>()</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">// Axis</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  axis1.OnInput();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  axis2.OnInput();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// -- Actions</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  action1.OnInput();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  action2.OnInput();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  action3.OnInput();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  action4.OnInput();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  run.OnInput();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  crouch.OnInput();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  jump.OnInput();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  console.OnInput();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// Mouse</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  mouse.OnInput();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// Comprobar estado antes de actualizar, por seguridad</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">//CheckJoysticks();</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoystick&gt;::iterator it = joysticks.begin(); it != joysticks.end(); ++it)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    (*it).OnInput();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a860cbb1a11819c52891ad48e811528a0">  199</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#a860cbb1a11819c52891ad48e811528a0">CSystem_UserInput::OnEvent</a>()</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;{</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  mouse.OnEvent();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a87ccd160385144f14d8f22e7898e0c18">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#a87ccd160385144f14d8f22e7898e0c18">CSystem_UserInput::OnLoop</a>()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  mouse.OnLoop();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  CheckJoysticks();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;}</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CheckJoysticks()</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// Wait for rebuilding...</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span>(rebuild_joysticks)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="__other_8h.html#accc6240d21a54f92d5c28505712d3de0">gSystem_Time</a>.<a class="code" href="class_c_system___time.html#a2d595246bea8b565970d80ba6874a0a3">GetTicks</a>() - rebuild_joysticks_timeout &lt; <a class="code" href="__input_8h.html#afa6246fb8268934cbb15493cbe24591d">__CSYSTEM_USERINPUT_JOYSTICK_REBUILD_TIMEOUT</a>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#a4d1935388fce9a094f6c1761219e326b">console_warning_msg</a>(<span class="stringliteral">&quot;Rebuilding joystick list...&quot;</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    RebuildJoysticks();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#a41f80851f8442f5a62824ca92e304780">console_info_msg</a>(<span class="stringliteral">&quot;Joystick rebuild done!&quot;</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    rebuild_joysticks = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// New joystick?</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)SDL_NumJoysticks() &gt; joysticks.size())</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#a41f80851f8442f5a62824ca92e304780">console_info_msg</a>(<span class="stringliteral">&quot;New joystick detected!&quot;</span>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    rebuild_joysticks = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    rebuild_joysticks_timeout = <a class="code" href="__other_8h.html#accc6240d21a54f92d5c28505712d3de0">gSystem_Time</a>.<a class="code" href="class_c_system___time.html#a2d595246bea8b565970d80ba6874a0a3">GetTicks</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Clear joysticks to avoid errors.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    joysticks.clear();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// Some other joystick is disconnected?</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoystick&gt;::iterator it = joysticks.begin(); it != joysticks.end(); ++it)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span>(!(*it).CheckStatus())</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      rebuild_joysticks = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      rebuild_joysticks_timeout = <a class="code" href="__other_8h.html#accc6240d21a54f92d5c28505712d3de0">gSystem_Time</a>.<a class="code" href="class_c_system___time.html#a2d595246bea8b565970d80ba6874a0a3">GetTicks</a>();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// Clear joysticks to avoid errors.</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      joysticks.clear();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordtype">bool</span> CSystem_UserInput::RebuildJoysticks()</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoystick&gt;::iterator it = joysticks.begin(); it != joysticks.end(); ++it)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    (*it).Close();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  joysticks.clear();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  SDL_JoystickUpdate();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">if</span> (<span class="keywordtype">int</span> njoy = SDL_NumJoysticks() &gt; 0)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    joysticks.resize(njoy);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span>(vector&lt;CJoystick&gt;::iterator it = joysticks.begin(); it != joysticks.end(); ++it)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordtype">int</span> index = it - joysticks.begin(); <span class="comment">// Truco sencillo para sacar el índice de un iterador</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">if</span>(!(*it).Init(index))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#adc1b3704e00e2eaefbe177acb37462b0">console_error_msg</a>(<span class="stringliteral">&quot;Error loading joystick %d&quot;</span>, index);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        joysticks.erase(it);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        it--;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a6ebc4e2b067b9ebfef95ce058c079cf0">  282</a></span>&#160;Uint8 <a class="code" href="class_c_system___user_input.html#a6ebc4e2b067b9ebfef95ce058c079cf0">CSystem_UserInput::Keyboard</a>(std::string keyname)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  SDL_Scancode key = SDL_GetScancodeFromName(keyname.c_str());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordflow">return</span> Keyboard(key);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#ae503bd120d94457b782fbdad2e87324b">  288</a></span>&#160;Uint8 <a class="code" href="class_c_system___user_input.html#a6ebc4e2b067b9ebfef95ce058c079cf0">CSystem_UserInput::Keyboard</a>(SDL_Scancode key)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span>(key == SDL_SCANCODE_UNKNOWN)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Simulamos que no se pulsa la tecla</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> keyboard[key];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">bool</span> CSystem_UserInput::CMouse::Init()</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  x = y = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  y_vel = x_vel = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  wheel_x = wheel_y = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  mouse1.state = mouse2.state = mouse3.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  mouse1.button = SDL_BUTTON_LEFT; mouse1.button_name = <span class="stringliteral">&quot;Mouse Left&quot;</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  mouse2.button = SDL_BUTTON_RIGHT; mouse2.button_name = <span class="stringliteral">&quot;Mouse Right&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  mouse3.button = SDL_BUTTON_MIDDLE; mouse2.button_name = <span class="stringliteral">&quot;Mouse Middle&quot;</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  moved = scrolled = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CMouse::OnLoop()</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  SDL_GetMouseState(&amp;x, &amp;y);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span>(!moved)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    x_vel = y_vel = 0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span>(!scrolled)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    wheel_x = wheel_y = 0;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  moved = scrolled = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CMouse::OnEvent()</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.type == SDL_MOUSEMOTION)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    x_vel = <span class="keyword">event</span>.motion.xrel;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    y_vel = <span class="keyword">event</span>.motion.yrel;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.type == SDL_MOUSEWHEEL)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    wheel_x = <span class="keyword">event</span>.wheel.x;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    wheel_y = <span class="keyword">event</span>.wheel.y;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    scrolled = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// Para simplificar, usamos 2 estados (pulsado y no-pulsado)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.type == SDL_MOUSEBUTTONDOWN)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse1.button and (mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a> or mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>))</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      mouse1.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      mouse1_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse2.button and (mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a> or mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      mouse2.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      mouse2_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse3.button and (mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a> or mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      mouse3.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      mouse3_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.type == SDL_MOUSEBUTTONUP)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse1.button and (mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a> or mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>))</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      mouse1.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      mouse1_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse2.button and (mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a> or mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>))</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      mouse2.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      mouse2_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a>.button.button == mouse3.button and (mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a> or mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>))</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      mouse3.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      mouse3_key = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CMouse::OnInput()</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">if</span>(!mouse1_key)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span>(mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      mouse1.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mouse1.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      mouse1.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">if</span>(!mouse2_key)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span>(mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      mouse2.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mouse2.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      mouse2.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span>(!mouse3_key)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span>(mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">key_keydown</a>)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      mouse3.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">key_pressed</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mouse3.state == <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">key_keyup</a>)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      mouse3.state = <a class="code" href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">key_unpressed</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  mouse1_key = mouse2_key = mouse3_key = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#af377c2350d7ccf81b38db43077ea6c0e">  408</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#af377c2350d7ccf81b38db43077ea6c0e">CSystem_UserInput::ShowMouse</a>(<span class="keywordtype">bool</span> show)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;{</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  SDL_ShowCursor(show);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a9f0ae1af526ec3bffb3613babe02a4a0">  413</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#a9f0ae1af526ec3bffb3613babe02a4a0">CSystem_UserInput::SetMousePos</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// Screen center</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span>(x == INT_MAX &amp;&amp; y == INT_MAX)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="__render_8h.html#af60b0de80285bd2531fa1c5eaf5cfec0">gSystem_Render</a>.<a class="code" href="class_c_system___render.html#a123fd5aa8d8a0dfef06d7ac7e335605a">GetWindowSize</a>(&amp;x, &amp;y);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    x /= 2;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    y /= 2;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  SDL_WarpMouseInWindow(<a class="code" href="__render_8h.html#af60b0de80285bd2531fa1c5eaf5cfec0">gSystem_Render</a>.<a class="code" href="class_c_system___render.html#ab8fc72e770a3b6ab4f95b2b81908925c">GetWindow</a>(), x, y);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="class_c_system___user_input.html#a14e363dff4d6cf25311926b601d8baf2">  426</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_system___user_input.html#a14e363dff4d6cf25311926b601d8baf2">CSystem_UserInput::SetMouseTrap</a>(<span class="keywordtype">bool</span> mode)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span>(mode) SDL_SetRelativeMouseMode(SDL_TRUE);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordflow">else</span>     SDL_SetRelativeMouseMode(SDL_FALSE);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordtype">bool</span> CSystem_UserInput::CJoystick::Init(<span class="keywordtype">int</span> index)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  joystick = SDL_JoystickOpen(index);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">if</span>(!joystick)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  joystick_name = SDL_JoystickNameForIndex(index);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  axes.resize(SDL_JoystickNumAxes(joystick));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  balls.resize(SDL_JoystickNumBalls(joystick));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  buttons.resize(SDL_JoystickNumButtons(joystick));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  povs.resize(SDL_JoystickNumHats(joystick));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CAxis&gt;::iterator it = axes.begin(); it != axes.end(); ++it)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    (*it).value = 0.f;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CBall&gt;::iterator it = balls.begin(); it != balls.end(); ++it)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   (*it).dx = (*it).dy = 0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoyButton&gt;::iterator it = buttons.begin(); it != buttons.end(); ++it)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="__globals_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> button_index = it - buttons.begin();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    (*it).button = button_index;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    (*it).state = <a class="code" href="namespace_input.html#aaa713ec744a1e7719a2413a644c7254eaa2a1dcaef61dee9df6ea97f0f0388337">button_unpressed</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    stringstream ss;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot;JOY&quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; [&quot;</span> &lt;&lt; joystick_name &lt;&lt; <span class="stringliteral">&quot;] Button&quot;</span> &lt;&lt; button_index;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    (*it).button_name = ss.str();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">for</span>(vector&lt;Uint8&gt;::iterator it = povs.begin(); it != povs.end(); ++it)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    (*it) = <a class="code" href="namespace_input.html#a69b06586b64474542769968276dd8483a790fba24369e1a8acbbfeb67ddd45369">pov_center</a>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CJoystick::Close()</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  axes.clear();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  buttons.clear();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  balls.clear();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  povs.clear();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  SDL_JoystickUpdate();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick))</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    SDL_JoystickClose(joystick);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">/*void CSystem_UserInput::CJoystick::OnEvent()</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">}*/</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// -&gt;NOTA Al parecer, la estructura de joysticks de SDL2 es un poco inestable, por lo que desconectar un mando en medio de la ejecución puede hacer que la aplicación crashee. Tal vez lo arreglen con el tiempo...</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keywordtype">void</span> CSystem_UserInput::CJoystick::OnInput()</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// Evitar problemas, o algo</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">//SDL_JoystickUpdate();</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Suponemos operaciones atómicas, por lo que solo comprobamos al principio.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick) == SDL_FALSE)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CAxis&gt;::iterator it = axes.begin(); it != axes.end(); ++it)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick) == SDL_TRUE)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      (*it).value = SDL_JoystickGetAxis(joystick, (it - axes.begin()))/32768.f;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">for</span>(vector&lt;Uint8&gt;::iterator it = povs.begin(); it != povs.end(); ++it)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick) == SDL_TRUE)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      (*it) = SDL_JoystickGetHat(joystick, it - povs.begin());</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CBall&gt;::iterator it = balls.begin(); it != balls.end(); ++it)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick) == SDL_TRUE and SDL_JoystickGetBall(joystick, it - balls.begin(), &amp;(*it).dx, &amp;(*it).dy) &lt; 0)</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a>.<a class="code" href="class_c_system___debug.html#adc1b3704e00e2eaefbe177acb37462b0">console_error_msg</a>(<span class="stringliteral">&quot;Error reading Ball%d from joystick %s: %s&quot;</span>, it - balls.begin(), joystick_name.c_str(), SDL_GetError());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">for</span>(vector&lt;CJoyButton&gt;::iterator it = buttons.begin(); it != buttons.end(); ++it)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span>(SDL_JoystickGetAttached(joystick) == SDL_TRUE)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      (*it).state = static_cast&lt;button_t&gt;((<span class="keywordtype">int</span>)SDL_JoystickGetButton(joystick, it - buttons.begin())); <span class="comment">// 1 -&gt; pressed, 0 -&gt; unpressed</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/*void CSystem_UserInput::CJoystick::OnLoop()</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">}*/</span></div>
<div class="ttc" id="class_c_system___user_input_html"><div class="ttname"><a href="class_c_system___user_input.html">CSystem_UserInput</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00034">_input.h:34</a></div></div>
<div class="ttc" id="__other_8h_html_accc6240d21a54f92d5c28505712d3de0"><div class="ttname"><a href="__other_8h.html#accc6240d21a54f92d5c28505712d3de0">gSystem_Time</a></div><div class="ttdeci">CSystem_Time gSystem_Time</div><div class="ttdef"><b>Definition:</b> <a href="__other_8cpp_source.html#l00003">_other.cpp:3</a></div></div>
<div class="ttc" id="class_c_system___render_html_ab8fc72e770a3b6ab4f95b2b81908925c"><div class="ttname"><a href="class_c_system___render.html#ab8fc72e770a3b6ab4f95b2b81908925c">CSystem_Render::GetWindow</a></div><div class="ttdeci">SDL_Window * GetWindow()</div><div class="ttdef"><b>Definition:</b> <a href="__render_8h_source.html#l00171">_render.h:171</a></div></div>
<div class="ttc" id="__input_8h_html"><div class="ttname"><a href="__input_8h.html">_input.h</a></div></div>
<div class="ttc" id="class_c_system___debug_html_a4d1935388fce9a094f6c1761219e326b"><div class="ttname"><a href="class_c_system___debug.html#a4d1935388fce9a094f6c1761219e326b">CSystem_Debug::console_warning_msg</a></div><div class="ttdeci">void console_warning_msg(const char *fmt,...)</div><div class="ttdoc">Escribir una línea de advertencia (naranja) en consola. </div><div class="ttdef"><b>Definition:</b> <a href="__debug_8cpp_source.html#l00622">_debug.cpp:622</a></div></div>
<div class="ttc" id="class_c_system___debug_html_adc1b3704e00e2eaefbe177acb37462b0"><div class="ttname"><a href="class_c_system___debug.html#adc1b3704e00e2eaefbe177acb37462b0">CSystem_Debug::console_error_msg</a></div><div class="ttdeci">void console_error_msg(const char *fmt,...)</div><div class="ttdoc">Escribir una línea de error (roja) en consola. </div><div class="ttdef"><b>Definition:</b> <a href="__debug_8cpp_source.html#l00605">_debug.cpp:605</a></div></div>
<div class="ttc" id="__debug_8h_html"><div class="ttname"><a href="__debug_8h.html">_debug.h</a></div><div class="ttdoc">Fichero que incluye la clase CSystem_Debug y sus estancias globales. </div></div>
<div class="ttc" id="class_c_system___time_html_a2d595246bea8b565970d80ba6874a0a3"><div class="ttname"><a href="class_c_system___time.html#a2d595246bea8b565970d80ba6874a0a3">CSystem_Time::GetTicks</a></div><div class="ttdeci">Uint32 GetTicks()</div><div class="ttdef"><b>Definition:</b> <a href="__other_8h_source.html#l00048">_other.h:48</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a6ebc4e2b067b9ebfef95ce058c079cf0"><div class="ttname"><a href="class_c_system___user_input.html#a6ebc4e2b067b9ebfef95ce058c079cf0">CSystem_UserInput::Keyboard</a></div><div class="ttdeci">Uint8 Keyboard(std::string keyname)</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00282">_input.cpp:282</a></div></div>
<div class="ttc" id="__input_8h_html_afa6246fb8268934cbb15493cbe24591d"><div class="ttname"><a href="__input_8h.html#afa6246fb8268934cbb15493cbe24591d">__CSYSTEM_USERINPUT_JOYSTICK_REBUILD_TIMEOUT</a></div><div class="ttdeci">#define __CSYSTEM_USERINPUT_JOYSTICK_REBUILD_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00008">_input.h:8</a></div></div>
<div class="ttc" id="__input_8h_html_a3ab458c50394cc90508977826a718f0e"><div class="ttname"><a href="__input_8h.html#a3ab458c50394cc90508977826a718f0e">gSystem_UserInput</a></div><div class="ttdeci">CSystem_UserInput gSystem_UserInput</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00006">_input.cpp:6</a></div></div>
<div class="ttc" id="namespace_debug_html_a49a7325e26aabc517b2104298dc39695ae46f71bd5ed0e9e76ba7cd4dd3b07019"><div class="ttname"><a href="namespace_debug.html#a49a7325e26aabc517b2104298dc39695ae46f71bd5ed0e9e76ba7cd4dd3b07019">Debug::error</a></div><div class="ttdef"><b>Definition:</b> <a href="__debug_8h_source.html#l00045">_debug.h:45</a></div></div>
<div class="ttc" id="__render_8h_html_af60b0de80285bd2531fa1c5eaf5cfec0"><div class="ttname"><a href="__render_8h.html#af60b0de80285bd2531fa1c5eaf5cfec0">gSystem_Render</a></div><div class="ttdeci">CSystem_Render gSystem_Render</div><div class="ttdef"><b>Definition:</b> <a href="__render_8cpp_source.html#l00017">_render.cpp:17</a></div></div>
<div class="ttc" id="class_c_system___debug_html_a0a3ec326a010e7b65ead579cc626442a"><div class="ttname"><a href="class_c_system___debug.html#a0a3ec326a010e7b65ead579cc626442a">CSystem_Debug::msg_box</a></div><div class="ttdeci">void msg_box(Uint32 flags, const char *title, const char *fmt,...)</div><div class="ttdoc">Mensaje estilo pop-up. </div><div class="ttdef"><b>Definition:</b> <a href="__debug_8cpp_source.html#l00343">_debug.cpp:343</a></div></div>
<div class="ttc" id="namespace_input_html_a69b06586b64474542769968276dd8483a790fba24369e1a8acbbfeb67ddd45369"><div class="ttname"><a href="namespace_input.html#a69b06586b64474542769968276dd8483a790fba24369e1a8acbbfeb67ddd45369">Input::pov_center</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00027">_input.h:27</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_aff3a72164d9831a8fbc86a8b6cd8d539"><div class="ttname"><a href="class_c_system___user_input.html#aff3a72164d9831a8fbc86a8b6cd8d539">CSystem_UserInput::Init</a></div><div class="ttdeci">bool Init()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00095">_input.cpp:95</a></div></div>
<div class="ttc" id="namespace_input_html_a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42"><div class="ttname"><a href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ab2a14db7cb6b6c1bb9de8017c1a21b42">Input::key_keydown</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00012">_input.h:12</a></div></div>
<div class="ttc" id="namespace_input_html_a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5"><div class="ttname"><a href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a3a56d261fedd7fad4868142877cad6c5">Input::key_pressed</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00012">_input.h:12</a></div></div>
<div class="ttc" id="__render_8h_html"><div class="ttname"><a href="__render_8h.html">_render.h</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a87ccd160385144f14d8f22e7898e0c18"><div class="ttname"><a href="class_c_system___user_input.html#a87ccd160385144f14d8f22e7898e0c18">CSystem_UserInput::OnLoop</a></div><div class="ttdeci">void OnLoop()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00204">_input.cpp:204</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a5ca889d8cf1d985713c0915463e2beb7"><div class="ttname"><a href="class_c_system___user_input.html#a5ca889d8cf1d985713c0915463e2beb7">CSystem_UserInput::Reset</a></div><div class="ttdeci">bool Reset()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00164">_input.cpp:164</a></div></div>
<div class="ttc" id="namespace_input_html_aaa713ec744a1e7719a2413a644c7254eaa2a1dcaef61dee9df6ea97f0f0388337"><div class="ttname"><a href="namespace_input.html#aaa713ec744a1e7719a2413a644c7254eaa2a1dcaef61dee9df6ea97f0f0388337">Input::button_unpressed</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00031">_input.h:31</a></div></div>
<div class="ttc" id="class_c_system___debug_html_a41f80851f8442f5a62824ca92e304780"><div class="ttname"><a href="class_c_system___debug.html#a41f80851f8442f5a62824ca92e304780">CSystem_Debug::console_info_msg</a></div><div class="ttdeci">void console_info_msg(const char *fmt,...)</div><div class="ttdoc">Escribir una línea de información (azul) en consola. </div><div class="ttdef"><b>Definition:</b> <a href="__debug_8cpp_source.html#l00639">_debug.cpp:639</a></div></div>
<div class="ttc" id="namespace_input_html_a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858"><div class="ttname"><a href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2ac16862c5b0f8c56b32ff3794f1706858">Input::key_keyup</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00012">_input.h:12</a></div></div>
<div class="ttc" id="group___sistemas_html_ga85bee145facae2ad509319caf538f4cd"><div class="ttname"><a href="group___sistemas.html#ga85bee145facae2ad509319caf538f4cd">gSystem_Data_Storage</a></div><div class="ttdeci">CSystem_Data_Storage gSystem_Data_Storage</div><div class="ttdoc">Objeto global del sistema &amp;quot;Data Storage&amp;quot;. </div><div class="ttdef"><b>Definition:</b> <a href="__data_8cpp_source.html#l00006">_data.cpp:6</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_af377c2350d7ccf81b38db43077ea6c0e"><div class="ttname"><a href="class_c_system___user_input.html#af377c2350d7ccf81b38db43077ea6c0e">CSystem_UserInput::ShowMouse</a></div><div class="ttdeci">void ShowMouse(bool show=true)</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00408">_input.cpp:408</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a860cbb1a11819c52891ad48e811528a0"><div class="ttname"><a href="class_c_system___user_input.html#a860cbb1a11819c52891ad48e811528a0">CSystem_UserInput::OnEvent</a></div><div class="ttdeci">void OnEvent()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00199">_input.cpp:199</a></div></div>
<div class="ttc" id="__globals_8h_html_a3d470c3e2db920debdd2f758bcc04dfa"><div class="ttname"><a href="__globals_8h.html#a3d470c3e2db920debdd2f758bcc04dfa">ERROR_INIT</a></div><div class="ttdeci">const char ERROR_INIT[]</div><div class="ttdoc">Título de error de inicialización para &amp;quot;message boxes&amp;quot;. </div><div class="ttdef"><b>Definition:</b> <a href="__globals_8h_source.html#l00152">_globals.h:152</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a5eb139fc1b46740a4fdf966fb4593e8b"><div class="ttname"><a href="class_c_system___user_input.html#a5eb139fc1b46740a4fdf966fb4593e8b">CSystem_UserInput::Close</a></div><div class="ttdeci">void Close()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00150">_input.cpp:150</a></div></div>
<div class="ttc" id="__data_8h_html"><div class="ttname"><a href="__data_8h.html">_data.h</a></div><div class="ttdoc">Fichero que incluye la clase CSystem_Data_Storage y sus estancias globales. </div></div>
<div class="ttc" id="group___sistemas_html_ga609832ffd83267e6eac2735ce8ba02ab"><div class="ttname"><a href="group___sistemas.html#ga609832ffd83267e6eac2735ce8ba02ab">gSystem_Debug</a></div><div class="ttdeci">CSystem_Debug gSystem_Debug</div><div class="ttdoc">Objeto global del sistema &amp;quot;Debug&amp;quot;. </div><div class="ttdef"><b>Definition:</b> <a href="__debug_8cpp_source.html#l00015">_debug.cpp:15</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a9f0ae1af526ec3bffb3613babe02a4a0"><div class="ttname"><a href="class_c_system___user_input.html#a9f0ae1af526ec3bffb3613babe02a4a0">CSystem_UserInput::SetMousePos</a></div><div class="ttdeci">void SetMousePos(int x=INT_MAX, int y=INT_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00413">_input.cpp:413</a></div></div>
<div class="ttc" id="class_c_system_html_adf0c79665d86344b1fbe187f5c6fa3c5"><div class="ttname"><a href="class_c_system.html#adf0c79665d86344b1fbe187f5c6fa3c5">CSystem::Close</a></div><div class="ttdeci">virtual void Close()</div><div class="ttdef"><b>Definition:</b> <a href="__system_8h_source.html#l00016">_system.h:16</a></div></div>
<div class="ttc" id="class_c_system_html_a5de409e36b7857940be16635a49101f9"><div class="ttname"><a href="class_c_system.html#a5de409e36b7857940be16635a49101f9">CSystem::Init</a></div><div class="ttdeci">virtual bool Init()</div><div class="ttdef"><b>Definition:</b> <a href="__system_8h_source.html#l00015">_system.h:15</a></div></div>
<div class="ttc" id="__globals_8h_html_a6b57f01d3c576db5368dd0efc2f435a4"><div class="ttname"><a href="__globals_8h.html#a6b57f01d3c576db5368dd0efc2f435a4">event</a></div><div class="ttdeci">SDL_Event event</div><div class="ttdoc">Estructura de eventos (entrada, salida, ventana, etc) principal de SDL2. </div><div class="ttdef"><b>Definition:</b> <a href="__globals_8cpp_source.html#l00003">_globals.cpp:3</a></div></div>
<div class="ttc" id="class_c_system___data___storage_html_a0ba4dc9145b9b9f6f7c17788537e6922"><div class="ttname"><a href="class_c_system___data___storage.html#a0ba4dc9145b9b9f6f7c17788537e6922">CSystem_Data_Storage::GetString</a></div><div class="ttdeci">std::string GetString(std::string name_id)</div><div class="ttdoc">Obtener el valor de un string. </div><div class="ttdef"><b>Definition:</b> <a href="__data_8cpp_source.html#l00271">_data.cpp:271</a></div></div>
<div class="ttc" id="namespace_input_html_a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6"><div class="ttname"><a href="namespace_input.html#a390530413cb8e38de0b6155e77cc72c2a29cfd1de426f7e1f9b9bb8a7a95740b6">Input::key_unpressed</a></div><div class="ttdef"><b>Definition:</b> <a href="__input_8h_source.html#l00012">_input.h:12</a></div></div>
<div class="ttc" id="__input_8h_html_a207511edbc2cbed20101d8f7b0987d0f"><div class="ttname"><a href="__input_8h.html#a207511edbc2cbed20101d8f7b0987d0f">gUserInput</a></div><div class="ttdeci">CSystem_UserInput &amp; gUserInput</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00007">_input.cpp:7</a></div></div>
<div class="ttc" id="class_c_system___render_html_a123fd5aa8d8a0dfef06d7ac7e335605a"><div class="ttname"><a href="class_c_system___render.html#a123fd5aa8d8a0dfef06d7ac7e335605a">CSystem_Render::GetWindowSize</a></div><div class="ttdeci">void GetWindowSize(int *w, int *h)</div><div class="ttdef"><b>Definition:</b> <a href="__render_8h_source.html#l00227">_render.h:227</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_aa4e4ab56ff55594d61fcc86ffa185a10"><div class="ttname"><a href="class_c_system___user_input.html#aa4e4ab56ff55594d61fcc86ffa185a10">CSystem_UserInput::OnInput</a></div><div class="ttdeci">void OnInput()</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00172">_input.cpp:172</a></div></div>
<div class="ttc" id="__globals_8h_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="__globals_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition:</b> <a href="__globals_8h_source.html#l00181">_globals.h:181</a></div></div>
<div class="ttc" id="class_c_system___user_input_html_a14e363dff4d6cf25311926b601d8baf2"><div class="ttname"><a href="class_c_system___user_input.html#a14e363dff4d6cf25311926b601d8baf2">CSystem_UserInput::SetMouseTrap</a></div><div class="ttdeci">void SetMouseTrap(bool mode=true)</div><div class="ttdef"><b>Definition:</b> <a href="__input_8cpp_source.html#l00426">_input.cpp:426</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generado el Sábado, 12 de Abril de 2014 11:05:32 para Go-Engine por &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
